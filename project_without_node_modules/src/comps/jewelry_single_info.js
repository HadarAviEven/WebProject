import React, { Component } from 'react';
import { Link } from "react-router-dom";

class JewelrySingleInfo extends Component {
    state = { jewelry_obj: {} }

    handleOnClick = () => {
        localStorage.setItem(this.state.jewelry_obj.title, this.state.jewelry_obj.title);
    };

    componentDidMount() {
        this.requestApi();
        // console.log({this.props.location.pathname});
    }

    componentDidUpdate(_newProps, _newState) {
        if (_newProps.match.params.id != this.props.match.params.id) {
            this.requestApi();
        }
    }

    requestApi = () => {
        let myUrl = "https://raw.githubusercontent.com/HadarAviEven/web_project/master/JewelryFinal.json"
        fetch(myUrl)
            .then(resp => resp.json())
            .then(data => {
                let obj = {};
                data.map((item) => {
                    if (item.id == this.props.match.params.id) {
                        obj = item;
                    }
                })
                this.setState({ jewelry_obj: obj })
            })
    }

    render() {
        let item = this.state.jewelry_obj;
        return (
            <div className="container-fluid bg-secondary text-white">
                <div className="container p-3 d-flex justify-content-center ">
                    <div className="col-lg-6 border border-warning p-3 font-italic rounded">
                        <div className="hover14 float-left mx-2 rounded">
                            <div>
                                <figure><img src={"/images/" + item.type + "/" + item.style + item.image} width="250" height="250" /></figure>
                            </div>
                        </div>
                        <h2>{item.title}</h2>
                        <div>Style: {item.style}</div>
                        <div>Carat: {item.carat} CT</div>
                        <div>Made in: {item.country}</div>
                        <div>Price: {item.price}$</div>
                        <div className="py-3">
                            <button onClick={this.handleOnClick} className="btn btn-warning text-white">Add to Cart</button>
                            <Link to="/" className="px-2">
                                <img className="rounded-circle" src="/images/back.jpg" width="40" />
                            </Link>
                        </div>
                    </div>
                </div>
            </div>
        );
    }
}
export default JewelrySingleInfo;